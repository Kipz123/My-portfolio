<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Blog Post - Allan Kaino</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css?family=Poppins:400,400i,500,500i,600,600i,700,700i,800,800i,900,900i"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,400i,600,600i,700" rel="stylesheet">
    <link href="AllanKaino.net/portfolio/css/bootstrap.min.css" rel="stylesheet">
    <link href="AllanKaino.net/portfolio/css/component.css" rel="stylesheet">
    <link href="AllanKaino.net/portfolio/css/circle.css" rel="stylesheet">
    <link href="AllanKaino.net/portfolio/css/font-awesome.min.css" rel="stylesheet">
    <link href="AllanKaino.net/portfolio/css/style.css" rel="stylesheet">
    <link href="AllanKaino.net/portfolio/css/skins/yellow.css" rel="stylesheet">
    <script src="AllanKaino.net/portfolio/js/modernizr.min.js"></script>
    <style>
        .blog-post-container {
            background: #252525;
            padding: 30px;
            border-radius: 5px;
            margin-top: 20px;
        }

        .blog-image {
            width: 100%;
            height: auto;
            border-radius: 5px;
            margin-bottom: 25px;
            max-height: 500px;
            object-fit: cover;
        }

        .blog-title {
            color: #ffb400;
            font-size: 2.5em;
            margin-bottom: 15px;
        }

        .blog-meta {
            color: #ccc;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #444;
        }

        .blog-content {
            color: #eee;
            font-size: 1.1em;
            line-height: 1.8;
            white-space: pre-wrap;
            /* Preserves newlines from the text area */
        }

        .nav-home-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        .nav-back-btn {
            position: fixed;
            top: 20px;
            right: 140px;
            z-index: 1000;
        }
    </style>
</head>

<body class="dark blog-page">
    <a href="/blog.html" class="button nav-back-btn">
        <span class="button-text">Back</span>
        <span class="button-icon fa fa-arrow-left"></span>
    </a>
    <a href="/AllanKaino.net/portfolio/dark.html" class="button nav-home-btn">
        <span class="button-text">Home</span>
        <span class="button-icon fa fa-home"></span>
    </a>

    <div class="pages">
        <div class="page page--current">
            <div class="container main-container">
                <div class="col-12 col-lg-10 offset-lg-1">
                    <div id="loading" class="text-center text-white">Loading...</div>
                    <div id="post-content" class="blog-post-container" style="display: none;">
                        <!-- Content injected by JS -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="AllanKaino.net/portfolio/js/jquery-3.5.0.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Get ID from URL query param
            const urlParams = new URLSearchParams(window.location.search);
            const id = urlParams.get('id');

            if (!id) {
                document.getElementById('loading').innerHTML = 'No blog ID specified.';
                return;
            }

            fetch(`/api/blogs/${id}`)
                .then(response => {
                    if (!response.ok) throw new Error('Blog not found');
                    return response.json();
                })
                .then(blog => {
                    const container = document.getElementById('post-content');
                    const loading = document.getElementById('loading');

                    let imageHtml = '';
                    if (blog.imagePath) {
                        imageHtml = `<img src="/uploads/${blog.imagePath}" class="blog-image" alt="${blog.title}">`;
                    }

                    const date = new Date(blog.createdAt).toLocaleDateString();

                    container.innerHTML = `
                    ${imageHtml}
                    <h1 class="blog-title">${blog.title}</h1>
                    <div class="blog-meta">
                        <span><i class="fa fa-user"></i> ${blog.author}</span>
                        <span class="ml-4"><i class="fa fa-calendar"></i> ${date}</span>
                    </div>
                    <div class="blog-content">${blog.content}</div>
                `;

                    loading.style.display = 'none';
                    container.style.display = 'block';
                })
                .catch(error => {
                    document.getElementById('loading').innerHTML = 'Error loading blog post.';
                    console.error('Error:', error);
                });
        });
    </script>
</body>

</html>